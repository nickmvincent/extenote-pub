---
import Layout from "../layouts/Base.astro";
import Nav from "../components/Nav.astro";
import Explorer from "../components/Explorer.jsx";
---

<Layout
  title="Grid Explorer"
  description="Interactive grid explorer for understanding data counterfactuals. Manipulate training sets and see how model performance changes."
>

<style is:global>
  :root{
    --bg:#0b1020;
    --bg-soft:#0e152b;
    --fg:#e9eef8;
    --muted:#9fb5c8;
    --card:#0f182f;
    --border:#1f2b45;
    --ring-thin:#ffce6a;
    --ring-thick:#33d6ff;
    --ring-select:#ffffff;
  }
  * { box-sizing:border-box }
  body { margin:0; background:radial-gradient(circle at 20% 20%, #101a34, #0b1020 45%), radial-gradient(circle at 80% 10%, #12203c, transparent 50%), var(--bg); color:var(--fg); font-family:ui-sans-serif,system-ui,-apple-system,Segoe UI,Roboto,Helvetica,Arial }
  a { color:var(--ring-thick); }
  .top-nav { position:sticky; top:0; z-index:20; backdrop-filter:blur(14px); background:rgba(11,12,16,0.82); border-bottom:1px solid var(--border); padding:8px 18px; display:flex; align-items:center; justify-content:space-between; gap:10px }
  .brand { font-weight:700; letter-spacing:0.04em; text-transform:uppercase; font-size:12px; color:var(--muted) }
  .nav-links { display:flex; gap:10px; flex-wrap:wrap }
  .nav-links a { padding:6px 10px; border:1px solid var(--border); border-radius:10px; text-decoration:none; color:var(--fg); font-size:12px; background:#111320; }
  .nav-links a:hover { border-color:var(--ring-thick); }
  .wrap { max-width:1250px; margin:0 auto; padding:16px }
  .section { margin:14px auto; }
  .lede { color:var(--muted); margin:6px 0 16px; max-width: 70ch; }
  .card { background:var(--card); border:1px solid var(--border); border-radius:14px; padding:12px; margin-bottom:12px }
  .row { display:grid; grid-template-columns:repeat(auto-fit, minmax(320px,1fr)); gap:12px }
  .ctrl { display:flex; align-items:center; gap:8px; margin:6px 0 10px; flex-wrap:wrap }
  .btn { border:1px solid var(--border); background:#141827; color:var(--fg); padding:6px 10px; border-radius:10px; cursor:pointer; font-size:12px }
  .btn[aria-pressed="true"] { outline:2px solid #7cc4ff }
  .btn.ghost { background:transparent }
  input[type="range"], select, input[type="checkbox"] { background:#141827; color:var(--fg); border:1px solid var(--border); border-radius:10px; padding:6px 10px }
  .grid-wrap { overflow:auto; border:1px solid var(--border); border-radius:14px; background:#0c101d }
  .rl, .cl, .cell { border-bottom:1px solid #2d3342; border-right:1px solid #2d3342 }
  .rl { width:58px; height:36px; display:flex; align-items:center; justify-content:flex-end; padding-right:6px; font-size:11px; cursor:pointer; position:sticky; left:0; background:var(--card); z-index:2; transition:background .2s ease, color .2s ease }
  .cl { width:38px; height:40px; display:flex; align-items:center; justify-content:center; font-size:11px; cursor:pointer; position:sticky; top:0; background:var(--card); z-index:3; transition:background .2s ease, color .2s ease }
  .cell { width:38px; height:36px; position:relative; cursor:pointer; transition:transform .18s ease, box-shadow .18s ease }
  .sel { outline:2px solid var(--ring-select); outline-offset:-2px; box-shadow:0 0 0 2px rgba(0,0,0,.4) inset }
  .num { position:absolute; inset:0; display:flex; align-items:center; justify-content:center; font-size:10px; font-weight:700; text-shadow:0 1px 1px rgba(0,0,0,.6) }
  .cell-emph { box-shadow:0 0 0 1px rgba(255,255,255,0.2) inset, 0 0 0 1px rgba(0,0,0,0.25); }
  .ring { position:absolute; inset:2px; outline:2px solid var(--ring-thin); outline-offset:-2px; border-radius:5px; box-shadow:0 0 0 2px rgba(0,0,0,.45) inset }
  .ring-thin { outline-color: var(--ring-thin); box-shadow:0 0 0 1px rgba(255,209,102,0.35), 0 0 0 2px rgba(0,0,0,.45) inset }
  .ring-thick { inset:4px; outline-color: var(--ring-thick); box-shadow:0 0 0 2px rgba(0,229,255,0.35), 0 0 0 2px rgba(0,0,0,.45) inset }
  .cell-pulse::after { content:""; position:absolute; inset:-6px; border:2px solid var(--ring-thick); border-radius:8px; opacity:0; animation:pulseCell 0.8s ease-out; pointer-events:none }
  @keyframes pulseCell { 0%{ opacity:0.8; transform:scale(0.9); } 50%{ opacity:0.4; transform:scale(1.05); } 100%{ opacity:0; transform:scale(1.12); } }
  .axis-active { background:#151a2b; color:#fff; }
  details { background:#0f1323; border:1px solid var(--border); border-radius:12px; padding:10px 12px }
  details + details { margin-top:8px }
  code { background:#0b0f1d; border:1px solid var(--border); padding:2px 5px; border-radius:6px }
  table.small { border-collapse:collapse; width:100%; font-size:12px }
  table.small th, table.small td { border:1px solid #2d3342; padding:4px 6px; text-align:right }
  table.small th:first-child, table.small td:first-child { text-align:left }
  .pill { display:inline-block; padding:2px 8px; border:1px solid var(--border); border-radius:999px; font-size:11px; color:var(--muted) }
  .spark { width: 260px; height: 50px; display:block }
  .blog { line-height:1.6 }
  .blog h2 { margin:0 0 10px }
  .blog p { margin:10px 0 }
  .blog ul { padding-left:20px; margin:10px 0 10px 18px; color:var(--muted) }
  .blog li { margin-bottom:6px }
  .controls-grid { display:grid; grid-template-columns:repeat(auto-fit,minmax(180px,1fr)); gap:8px }
  .ctrl-block { background:#0d1120; border:1px solid var(--border); border-radius:10px; padding:8px; display:flex; flex-direction:column; gap:4px }
  .ctrl-title { font-size:10px; text-transform:uppercase; letter-spacing:0.08em; color:var(--muted); display:flex; align-items:center; gap:4px }
  .ctrl-content { display:flex; flex-wrap:wrap; gap:4px; align-items:center }
  .ctrl-content select, .ctrl-content input[type="range"], .ctrl-content input[type="checkbox"] { flex:1 }
  .ctrl-note { font-size:10px; color:var(--muted) }
  .tutorials { display:grid; grid-template-columns:repeat(auto-fit,minmax(180px,1fr)); gap:8px }
  .tutorial-btn { border:1px solid var(--border); background:#101423; color:var(--fg); text-align:left; padding:8px 10px; border-radius:10px; cursor:pointer; font-size:13px; line-height:1.3 }
  .tutorial-btn.active { border-color:var(--ring-thick); box-shadow:0 0 0 1px var(--ring-thick) inset; background:#111a2f }
  .tutorial-title { font-weight:600; display:block }
  .tutorial-desc { display:block; font-size:12px; color:var(--muted); margin-top:2px }
  .tutorial-note { margin-top:10px; font-size:13px; color:var(--muted); background:#0d1120; border:1px solid var(--border); border-radius:10px; padding:10px 12px; line-height:1.5 }
  .info-tip { display:inline-flex; align-items:center; justify-content:center; width:16px; height:16px; border:1px solid var(--border); border-radius:50%; font-size:11px; color:var(--muted); cursor:help }
  .btn.mini { padding:4px 8px; font-size:11px }
  .layout-shell { display:grid; grid-template-columns: var(--layout-cols, 320px minmax(420px,1fr) 320px); gap:14px; align-items:start }
  .side-panel { display:flex; flex-direction:column; gap:14px; transition:width .22s ease, opacity .22s ease; min-width:0 }
  .side-panel.closed { width:0; opacity:0; pointer-events:none }
  .side-panel .card { background:#0f1323 }
  .grid-center { display:flex; flex-direction:column; gap:12px; position:relative }
  .panel-toggles { display:flex; justify-content:space-between; gap:8px; flex-wrap:wrap }
  .edge-toggle { font-size:12px; border:1px dashed var(--border); background:#0d1120; color:var(--muted); border-radius:10px; padding:6px 10px; cursor:pointer }
  @media (max-width:1180px){
    .layout-shell { grid-template-columns:1fr !important; }
    .side-panel { width:100%; opacity:1; pointer-events:auto; }
    .side-panel.closed { width:100%; opacity:1; pointer-events:auto; }
    .panel-toggles { justify-content:flex-end; }
  }
  .col-stack > .card + .card { margin-top:14px }
  .preset-flash { animation:presetFlash 0.8s ease }
  @keyframes presetFlash { 0%{ box-shadow:0 0 0 0 rgba(0,229,255,0.35); } 50%{ box-shadow:0 0 0 14px rgba(0,229,255,0.12); } 100%{ box-shadow:0 0 0 0 rgba(0,229,255,0); } }
  .computed-flash { animation:computedFlash 0.9s ease }
  @keyframes computedFlash { 0%{ box-shadow:0 0 0 0 rgba(255,209,102,0.18); } 40%{ box-shadow:0 0 0 12px rgba(255,209,102,0.12); } 100%{ box-shadow:0 0 0 0 rgba(255,209,102,0); } }
  .json-block { background:#0c0f1c; border:1px solid var(--border); border-radius:10px; padding:8px; font-family:"SFMono-Regular",Consolas,Menlo,monospace; font-size:12px; color:var(--muted); overflow:auto; line-height:1.35 }
  .guide-details summary { cursor:pointer; font-weight:600; font-size:14px; }
</style>

<Nav />

<section id="explore" class="section" aria-label="Explore">
  <Explorer client:load />
</section>

</Layout>
